<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>INTRODUCTION TO DIGITAL MUSICOLOGY - Exercise for Week X</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../references.html" rel="next">
<link href="../ex/02_python_primer.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ex/01_what_is_dm.html">EXERCISES</a></li><li class="breadcrumb-item"><a href="../ex/03_melody_I.html">Exercise for Week X</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">INTRODUCTION TO DIGITAL MUSICOLOGY</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">INTRODUCTION</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_what_is_dm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What is Digital Musicology?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_dm_today.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Digital Musicology today</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_history_of_dm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The history of Digital Musicology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">DATA ABOUT MUSIC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_RISM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RISM metadata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_spotify_musicbrainz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spotify and MusicBrainz metadata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_streaming_industry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Music and the streaming industry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../billboard_charts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analyzing song survival</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">MUSIC AS DATA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_audio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Audio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_MIDI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">MIDI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_ABC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">ABC</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10_MEI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">MEI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">WORKING WITH MUSIC DATA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11_dma_harmony.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Digital music analysis: harmony</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../12_dma_melody.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Digital music analysis: melody</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_jazz_solos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Solos in the <em>Weimar Jazz Database</em></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_data-driven_music_history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Data-Driven Music History</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">CRITICAL DIGITAL MUSICOLOGY</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13_copyright.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Copyright</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14_representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Representation and representativeness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15_discussion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Discussion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">EXERCISES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/01_what_is_dm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise for Week 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/02_python_primer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise for Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ex/03_melody_I.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exercise for Week X</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">REFERENCES</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#finding-similarities-and-differences-in-folk-melodies-with-python-and-pandas" id="toc-finding-similarities-and-differences-in-folk-melodies-with-python-and-pandas" class="nav-link active" data-scroll-target="#finding-similarities-and-differences-in-folk-melodies-with-python-and-pandas">Finding Similarities and Differences in Folk Melodies with Python and Pandas</a>
  <ul class="collapse">
  <li><a href="#step-1-preprocessing" id="toc-step-1-preprocessing" class="nav-link" data-scroll-target="#step-1-preprocessing">Step 1: Preprocessing</a></li>
  </ul></li>
  <li><a href="#step-2-extract-the-root-and-mode-of-the-pieces-and-write-them-in-new-columns" id="toc-step-2-extract-the-root-and-mode-of-the-pieces-and-write-them-in-new-columns" class="nav-link" data-scroll-target="#step-2-extract-the-root-and-mode-of-the-pieces-and-write-them-in-new-columns">Step 2: Extract the root and mode of the pieces and write them in new columns</a></li>
  <li><a href="#step-3-create-one-new-column-for-each-pitch-class-in-order-to-extract-pitch-class-counts" id="toc-step-3-create-one-new-column-for-each-pitch-class-in-order-to-extract-pitch-class-counts" class="nav-link" data-scroll-target="#step-3-create-one-new-column-for-each-pitch-class-in-order-to-extract-pitch-class-counts">Step 3: Create one new column for each pitch class in order to extract pitch-class counts</a></li>
  <li><a href="#step-4-plot-your-first-pitch-class-histogram-and-pitch-class-distribution" id="toc-step-4-plot-your-first-pitch-class-histogram-and-pitch-class-distribution" class="nav-link" data-scroll-target="#step-4-plot-your-first-pitch-class-histogram-and-pitch-class-distribution">Step 4: Plot your first pitch class histogram and pitch class distribution</a></li>
  <li><a href="#step-5-plot-the-averaged-pitch-class-distribution-for-the-major-and-the-minor-mode" id="toc-step-5-plot-the-averaged-pitch-class-distribution-for-the-major-and-the-minor-mode" class="nav-link" data-scroll-target="#step-5-plot-the-averaged-pitch-class-distribution-for-the-major-and-the-minor-mode">Step 5: Plot the averaged pitch class distribution for the major and the minor mode</a></li>
  <li><a href="#step-6-plot-the-averaged-distributions-in-fifths-ordering" id="toc-step-6-plot-the-averaged-distributions-in-fifths-ordering" class="nav-link" data-scroll-target="#step-6-plot-the-averaged-distributions-in-fifths-ordering">Step 6: Plot the averaged distributions in fifths ordering</a></li>
  <li><a href="#step-7-extend-the-plot-above-to-show-the-diffusion-of-each-pitch-class" id="toc-step-7-extend-the-plot-above-to-show-the-diffusion-of-each-pitch-class" class="nav-link" data-scroll-target="#step-7-extend-the-plot-above-to-show-the-diffusion-of-each-pitch-class">Step 7: Extend the plot above to show the diffusion of each pitch class</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ex/01_what_is_dm.html">EXERCISES</a></li><li class="breadcrumb-item"><a href="../ex/03_melody_I.html">Exercise for Week X</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exercise for Week X</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="finding-similarities-and-differences-in-folk-melodies-with-python-and-pandas" class="level2">
<h2 class="anchored" data-anchor-id="finding-similarities-and-differences-in-folk-melodies-with-python-and-pandas">Finding Similarities and Differences in Folk Melodies with Python and Pandas</h2>
<p>In this exercise we will have a look at the <strong>Essen Folksong Collection (EFD)</strong>. It is a database of Folksongs from all around the world gathered by the ethnomusicologist Helmut Schaffrath (1995). The collection can be downloaded from <a href="http://www.esac-data.org/">this website</a>. It comes in the **kern format that is a table of note events where the rows correspond to event time.</p>
<p>We will answer a very specific question:</p>
<p><strong>What can we learn about musical scales when we look at the notes in a musical piece?</strong></p>
<p>For this purpose and also due to limited time, we need to make some simplifications. We will only consider <strong>note counts</strong>. That means, for this excercise we just count all the notes in a piece but do not care how long the notes are. Another way to say it is that we are just interested in the pitch dimension.</p>
<p>Notes in the EFD come as <strong>spelled pitches</strong>. Spelled pitches have three parts: 1. the diatonic step (C, D, E, F, G, A, or B) 2. possibly one or two accidentals (# or b) 3. the octave in which the note sounds</p>
<p>Moreover, we will reduce the pitches in a melody to <strong>pitch classe</strong>. This means we do not differentiate between the same pitches in different octaves, e.g.&nbsp;C4 and C5, nor will we distinguish between enharmonically equivalent pitches, such as F#3 and Gb3.</p>
<p>This way, each piece can be represented as a list of pitch classes that can then be counted.</p>
<p>Because it is not straight-forward to work with **kern scores in Python, the data was already transformed into DataFrame format and exported to <code>data.csv</code>.</p>
<p>First, we need to import sum libraries that contain the functions that we will use for the data analysis. If you do not have one or more of the packages installed, run <code>conda install packages-names</code> in a command-line tool (as adminstrator).</p>
<<<<<<< HEAD
<div id="7cc75144" class="cell" data-execution_count="1">
=======
<div id="7a2918e8" class="cell" data-execution_count="1">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># for numerical computation (we need it to transpose melodies)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># to organize our data in tabular format</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt <span class="co"># to visualize results </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns <span class="co"># more advanced visualization tools</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># directly show the plots in the notebook</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re <span class="co"># regular expressions: for pattern finding in strings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="step-1-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="step-1-preprocessing">Step 1: Preprocessing</h3>
<section id="read-the-data-and-create-new-column-that-contains-a-list-of-the-pitches-of-the-melody" class="level4">
<h4 class="anchored" data-anchor-id="read-the-data-and-create-new-column-that-contains-a-list-of-the-pitches-of-the-melody">Read the data and create new column that contains a list of the pitches of the melody</h4>
<<<<<<< HEAD
<div id="34153fcb" class="cell" data-execution_count="2">
=======
<div id="c48d7119" class="cell" data-execution_count="2">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"../data/essen_data.csv"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">DGIs</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>africa</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>['P4', 'M2', 'm2', 'M2', 'M-2', 'P1', 'm-2', '...</td>
<td>['D5', 'G5', 'A5', 'B-5', 'C6', 'B-5', 'B-5', ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>mexico</td>
<td>CUCA 1</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>['C4', 'C4', 'C4', 'F4', 'A4', 'C4', 'C4', 'C4...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>mexico</td>
<td>CUCA 2</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>['C4', 'C4', 'C4', 'F4', 'A4', 'C4', 'C4', 'C4...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>mexico</td>
<td>CUCA 1</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>['C4', 'C4', 'C4', 'F4', 'A4', 'C4', 'C4', 'C4...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>mexico</td>
<td>CUCA 2</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>['C4', 'C4', 'C4', 'F4', 'A4', 'C4', 'C4', 'C4...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Wee see that the (preprocessed) data comes with the features <code>region</code>, <code>title</code>, and <code>key</code>, and is represended as <strong>directed generic intervals</strong> (<code>DGIs</code>) and <code>spelled_pitches</code>.</p>
<p>For this excercise we will only work with the data in the <code>key</code> and <code>spelled_pitches</code> columns. The <code>spelled_pitches</code> entries look like a list of pitches but they are actually strings (<code>'['</code>, <code>','</code> and whitespaces are characters). Therefore we need to first transform it into a representation that we can work with. We will not go into details here but basically we just remove everything that we don’t need from the string until only the spelled pitches are left.</p>
<<<<<<< HEAD
<div id="a2458687" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'spelled_pitches'</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">'spelled_pitches'</span>].<span class="bu">str</span>.replace(<span class="st">"', '"</span>, <span class="st">" "</span>).<span class="bu">str</span>.replace(<span class="st">"['"</span>, <span class="st">""</span>).<span class="bu">str</span>.replace(<span class="st">"']"</span>, <span class="st">""</span>).<span class="bu">str</span>.strip()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a35aec85" class="cell" data-execution_count="4">
=======
<div id="2e2da8dc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'spelled_pitches'</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">'spelled_pitches'</span>].<span class="bu">str</span>.replace(<span class="st">"', '"</span>, <span class="st">" "</span>).<span class="bu">str</span>.replace(<span class="st">"['"</span>, <span class="st">""</span>).<span class="bu">str</span>.replace(<span class="st">"']"</span>, <span class="st">""</span>).<span class="bu">str</span>.strip()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c10ef1c9" class="cell" data-execution_count="4">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">DGIs</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>africa</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>['P4', 'M2', 'm2', 'M2', 'M-2', 'P1', 'm-2', '...</td>
<td>D5 G5 A5 B-5 C6 B-5 B-5 A5 A5 G5 G5 F#5 G5 A5 ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>mexico</td>
<td>CUCA 1</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>mexico</td>
<td>CUCA 2</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>mexico</td>
<td>CUCA 1</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>mexico</td>
<td>CUCA 2</td>
<td>F major</td>
<td>['P1', 'P1', 'P4', 'M3', 'M-6', 'P1', 'P1', 'P...</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Let’s also drop the columns that we don’t need for this excercise.</p>
<<<<<<< HEAD
<div id="797c5aa2" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> data[<span class="st">'region'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> data[<span class="st">'DGIs'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ae3732d3" class="cell" data-execution_count="6">
=======
<div id="af479809" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> data[<span class="st">'region'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> data[<span class="st">'DGIs'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="da7aaeab" class="cell" data-execution_count="6">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>D5 G5 A5 B-5 C6 B-5 B-5 A5 A5 G5 G5 F#5 G5 A5 ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUCA 1</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUCA 2</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUCA 1</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUCA 2</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Let us inspect the data bit further with the <code>describe</code> method.</p>
<<<<<<< HEAD
<div id="ffe92fc3" class="cell" data-execution_count="7">
=======
<div id="e20ad334" class="cell" data-execution_count="7">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>9373</td>
<td>9372</td>
<td>9373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>7783</td>
<td>22</td>
<td>9015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>Melodia instrumentalna</td>
<td>G major</td>
<td>B3 E4 F#4 G4 F#4 E4 B4 F#4 A4 G4 F#4 E4 D#4 E4...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>84</td>
<td>2831</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>It seems that we have some duplicates with different titles in the dataset. Normally, we should deal with this issue. For now we will treat them as separate songs. Also we can see that apparently there is missing key information for one song. Let’s see where this happens.</p>
<<<<<<< HEAD
<div id="333a9cd5" class="cell" data-execution_count="8">
=======
<div id="c52f1167" class="cell" data-execution_count="8">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data[ data[<span class="st">'key'</span>].isnull() ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1028</td>
<td>Yidui gezi xukongli fei</td>
<td>NaN</td>
<td>[]</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Since we have only the title for this song, it doesn’t make much sense to include it into our analysis. We will exclude it and drop this row from the DataFrame.</p>
<<<<<<< HEAD
<div id="d40f8964" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data.drop(<span class="dv">1028</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d67fa739" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="42dab24d" class="cell" data-execution_count="11">
=======
<div id="b047803f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data.drop(<span class="dv">1028</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ed994a68" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c34608e6" class="cell" data-execution_count="11">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(9372, 3)</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="step-2-extract-the-root-and-mode-of-the-pieces-and-write-them-in-new-columns" class="level2">
<h2 class="anchored" data-anchor-id="step-2-extract-the-root-and-mode-of-the-pieces-and-write-them-in-new-columns">Step 2: Extract the root and mode of the pieces and write them in new columns</h2>
<p>Translate the keys into modes and pitch classes of roots. The easiest way might be to write a dictionary by hand that does the job.</p>
<<<<<<< HEAD
<div id="14dd7584" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data[[<span class="st">'root'</span>, <span class="st">'mode'</span>]] <span class="op">=</span> data[<span class="st">'key'</span>].<span class="bu">str</span>.split(<span class="st">" "</span>, expand<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8bbb3b1c" class="cell" data-execution_count="13">
=======
<div id="91898d6c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data[[<span class="st">'root'</span>, <span class="st">'mode'</span>]] <span class="op">=</span> data[<span class="st">'key'</span>].<span class="bu">str</span>.split(<span class="st">" "</span>, expand<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d4fbc134" class="cell" data-execution_count="13">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
<th data-quarto-table-cell-role="th">root</th>
<th data-quarto-table-cell-role="th">mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>D5 G5 A5 B-5 C6 B-5 B-5 A5 A5 G5 G5 F#5 G5 A5 ...</td>
<td>g</td>
<td>minor</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUCA 1</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
<td>F</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUCA 2</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
<td>F</td>
<td>major</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUCA 1</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
<td>F</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUCA 2</td>
<td>F major</td>
<td>C4 C4 C4 F4 A4 C4 C4 C4 F4 A4 F4 F4 E4 E4 D4 D...</td>
<td>F</td>
<td>major</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>It is always a good idea to inspect the data to understand it better. What are the proportions of major and minor pieces in this dataset?</p>
<<<<<<< HEAD
<div id="bf4152a1" class="cell" data-execution_count="14">
=======
<div id="758807d9" class="cell" data-execution_count="14">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'mode'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>mode
major    8388
minor     984
Name: count, dtype: int64</code></pre>
</div>
</div>
<<<<<<< HEAD
<div id="2308a829" class="cell" data-execution_count="15">
=======
<div id="2cd4d519" class="cell" data-execution_count="15">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'mode'</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>mode
major    0.895006
minor    0.104994
Name: count, dtype: float64</code></pre>
</div>
</div>
<<<<<<< HEAD
<div id="16927143" class="cell" data-execution_count="16">
=======
<div id="9a95a83a" class="cell" data-execution_count="16">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>root
G     2831
F     1878
C     1309
B-     664
D      648
A      553
g      370
E-     289
a      284
d      170
E      150
e      109
A-      56
f       19
c       17
b-       8
D-       6
B        4
d-       2
f#       2
b        2
e-       1
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>We don’t want to distinguish between the roots of major and minor keys, so we just write all the roots as uppercase letters.</p>
<<<<<<< HEAD
<div id="80e68903" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>] <span class="op">=</span> data[<span class="st">'root'</span>].<span class="bu">str</span>.upper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b0da81fb" class="cell" data-execution_count="18">
=======
<div id="dae81277" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>] <span class="op">=</span> data[<span class="st">'root'</span>].<span class="bu">str</span>.upper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0359b398" class="cell" data-execution_count="18">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>root
G     3201
F     1897
C     1326
A      837
D      818
B-     672
E-     290
E      259
A-      56
D-       8
B        6
F#       2
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>In order to transpose all the melodies to the same key, we need to know the pitch-class of each root. We will use a pragmatic approach and just explicitly state the information in a dictionary. It is common to define <code>'C'</code> as pitch class <code>0</code>.</p>
<<<<<<< HEAD
<div id="cdc4c669" class="cell" data-execution_count="19">
=======
<div id="b0dc8e33" class="cell" data-execution_count="19">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>roots_dict <span class="op">=</span> { </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>:<span class="dv">7</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F'</span>:<span class="dv">5</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C'</span>:<span class="dv">0</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>:<span class="dv">9</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>:<span class="dv">2</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B-'</span>:<span class="dv">10</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'E-'</span>:<span class="dv">3</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'E'</span>:<span class="dv">4</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A-'</span>:<span class="dv">8</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D-'</span>:<span class="dv">1</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B'</span>:<span class="dv">11</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F#'</span>:<span class="dv">6</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No we can translate the roots to pitch classes.</p>
<<<<<<< HEAD
<div id="db5e60e9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>] <span class="op">=</span> data[<span class="st">'root'</span>].<span class="bu">map</span>(roots_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="49abfc1e" class="cell" data-execution_count="21">
=======
<div id="eec4a5b9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'root'</span>] <span class="op">=</span> data[<span class="st">'root'</span>].<span class="bu">map</span>(roots_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="72742333" class="cell" data-execution_count="21">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
<th data-quarto-table-cell-role="th">root</th>
<th data-quarto-table-cell-role="th">mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9367</td>
<td>Die schoene Magdalena Was geschah an einem Mon...</td>
<td>G major</td>
<td>D4 D4 G4 G4 G4 E5 D5 B4 G4 D5 D5 C5 A4 F#4 D5 ...</td>
<td>7</td>
<td>major</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9368</td>
<td>Das Maedchen und der Faehnrich 'Ach Tochter, l...</td>
<td>G major</td>
<td>D4 G4 A4 B4 C5 D5 B4 G4 G4 E5 E5 G5 E5 E5 D5 D...</td>
<td>7</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9369</td>
<td>Das Maedchen und der Faehnrich Es war ein reic...</td>
<td>G major</td>
<td>B4 D5 B4 D5 E5 D5 C5 B4 C5 D5 B4 A4 A4 G4 A4 D...</td>
<td>7</td>
<td>major</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9370</td>
<td>Der schwatzhafte Junggeselle Es waren drei Ges...</td>
<td>F major</td>
<td>C4 F4 E4 D4 C4 A4 G4 F4 C4 F4 E4 D4 C4 A4 G4 F...</td>
<td>5</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9371</td>
<td>Verschlafener Jaeger Es wollt ein Jaeger frueh...</td>
<td>A major</td>
<td>E4 A4 E4 E4 F#4 G#4 A4 F#4 F#4 F#4 F#4 A4 G#4 ...</td>
<td>9</td>
<td>major</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="step-3-create-one-new-column-for-each-pitch-class-in-order-to-extract-pitch-class-counts" class="level2">
<h2 class="anchored" data-anchor-id="step-3-create-one-new-column-for-each-pitch-class-in-order-to-extract-pitch-class-counts">Step 3: Create one new column for each pitch class in order to extract pitch-class counts</h2>
<p>First, we transform the melody into a list of spelled pitches.</p>
<<<<<<< HEAD
<div id="85ae3c9f" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'spelled_pitches'</span>] <span class="op">=</span> data[<span class="st">'spelled_pitches'</span>].<span class="bu">str</span>.split()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6238cc67" class="cell" data-execution_count="23">
=======
<div id="5204a25a" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'spelled_pitches'</span>] <span class="op">=</span> data[<span class="st">'spelled_pitches'</span>].<span class="bu">str</span>.split()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="aa74c6e1" class="cell" data-execution_count="23">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
<th data-quarto-table-cell-role="th">root</th>
<th data-quarto-table-cell-role="th">mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>[D5, G5, A5, B-5, C6, B-5, B-5, A5, A5, G5, G5...</td>
<td>7</td>
<td>minor</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUCA 1</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUCA 2</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUCA 1</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUCA 2</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Next, we need a way to transform each pitch to a pitch class. To that end we define a function that takes a spelled pitch (a symbol such as <code>B-5</code>) and returns it’s pitch class as a number between <code>0</code> and <code>12</code>.</p>
<<<<<<< HEAD
<div id="00c70756" class="cell" data-execution_count="24">
=======
<div id="da11481e" class="cell" data-execution_count="24">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spelled_pitch_to_pitch_class(spelled_pitch):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">    This function transforms a spelled pitch, such as, `B-5` </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">    into a pitch class, a number between 0 and 12.</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">    A spelled pitch consists of three parts:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Its diatonic step (C, D, E, F, G, A, or B)</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Potentially one or two accidentals (# or b)</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">    3. Its octave as a number.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove octave by removing the last character in the string</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    spelled_pitch_class <span class="op">=</span> spelled_pitch[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the diatonic step</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First, we define a dictionary that associates </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># each diatonic step with a pitch class</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    pitch_classes <span class="op">=</span> {</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'C'</span>:<span class="dv">0</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'D'</span>:<span class="dv">2</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'E'</span>:<span class="dv">4</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'F'</span>:<span class="dv">5</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'G'</span>:<span class="dv">7</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>:<span class="dv">9</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'B'</span>:<span class="dv">11</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract accidentals</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We define a regular expression that finds the three parts </span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># of a spelled pitch class. </span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    match <span class="op">=</span> re.match(<span class="vs">r'(\w)(\#*)(-*)'</span>, spelled_pitch_class).group(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we find a match, we get a tripel (step, sharps, flats)</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> match:</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        step <span class="op">=</span> pitch_classes[match[<span class="dv">0</span>]]</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>        sharps <span class="op">=</span> <span class="bu">len</span>(match[<span class="dv">1</span>])</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        flats <span class="op">=</span> <span class="bu">len</span>(match[<span class="dv">2</span>])</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The only thing left to do is to take the pitch class of the diatonic step,</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add the number of sharps and subtract the number of flats</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finally, since pitch classes are always between 0 and 11, we take this number mod 12.</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (step <span class="op">+</span> sharps <span class="op">-</span> flats) <span class="op">%</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the previous step we set up a function that converts spelled pitches into pitch classes. Now we can use it to count all the notes in a piece.</p>
<<<<<<< HEAD
<div id="b29d7f3a" class="cell" data-execution_count="25">
=======
<div id="f25e8ddb" class="cell" data-execution_count="25">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we set up an empty list that will later contain dictionaries of pitch-class counts for each song. </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>countdicts <span class="op">=</span> []</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we loop over all the rows (pieces) in our dataframe </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> data.iterrows():</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We replace the spelled pitches with pitch classes</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">'spelled_pitches'</span>] <span class="op">=</span> [spelled_pitch_to_pitch_class(pitch) <span class="cf">for</span> pitch <span class="kw">in</span> row[<span class="st">'spelled_pitches'</span>]]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Then we count the occurences of each pitch class in this list</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We create an empty dictionary that will contain the pitch-class counts for the current piece</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    intcounts <span class="op">=</span> {}</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We iterate over all pitch classes and see if it is already in the `intcounts` dictionary</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pitch_class <span class="kw">in</span> row[<span class="st">'spelled_pitches'</span>]:</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if not, set the count to 1</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pitch_class <span class="kw">not</span> <span class="kw">in</span> intcounts.keys():</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>            intcounts[pitch_class] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if yes, increment the count by 1</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>            intcounts[pitch_class] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finally, add the pitch-class counts dictionary to our list of pitch-class count dictionaries</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    countdicts.append(intcounts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is what the first 10 entries in the list of pitch-class count dictionaries looks like:</p>
<<<<<<< HEAD
<div id="72a5e38c" class="cell" data-execution_count="26">
=======
<div id="4ac86a8c" class="cell" data-execution_count="26">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>countdicts[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>[{2: 17, 7: 32, 9: 29, 10: 23, 0: 11, 6: 12, 3: 8, 5: 2, 4: 1},
 {0: 25, 5: 7, 9: 9, 4: 6, 2: 5, 7: 8, 10: 5},
 {0: 25, 5: 8, 9: 11, 4: 6, 2: 5, 7: 10, 10: 5},
 {0: 25, 5: 7, 9: 9, 4: 6, 2: 5, 7: 8, 10: 5},
 {0: 25, 5: 8, 9: 11, 4: 6, 2: 5, 7: 10, 10: 5},
 {0: 4, 5: 3, 9: 1, 2: 4, 7: 3, 4: 1},
 {5: 11, 0: 5, 7: 6, 9: 10, 10: 1},
 {2: 10, 11: 15, 9: 12, 7: 7, 6: 2, 0: 2},
 {7: 9, 11: 8, 9: 11, 2: 8, 0: 4, 6: 2, 4: 2},
 {7: 8, 9: 10, 11: 17, 0: 8, 2: 6, 4: 2}]</code></pre>
</div>
</div>
<p>This is not really convenient. To handle it easier, we transform it to a DataFrame object and set all pitch classes to <code>0</code> if they do not occur in a piece.</p>
<<<<<<< HEAD
<div id="63686048" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> pd.DataFrame(countdicts).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a41248f8" class="cell" data-execution_count="28">
=======
<div id="f137e84a" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> pd.DataFrame(countdicts).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="57fcfc7d" class="cell" data-execution_count="28">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>counts.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>17.0</td>
<td>32.0</td>
<td>29.0</td>
<td>23.0</td>
<td>11.0</td>
<td>12.0</td>
<td>8.0</td>
<td>2.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.0</td>
<td>8.0</td>
<td>9.0</td>
<td>5.0</td>
<td>25.0</td>
<td>0.0</td>
<td>0.0</td>
<td>7.0</td>
<td>6.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.0</td>
<td>10.0</td>
<td>11.0</td>
<td>5.0</td>
<td>25.0</td>
<td>0.0</td>
<td>0.0</td>
<td>8.0</td>
<td>6.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.0</td>
<td>8.0</td>
<td>9.0</td>
<td>5.0</td>
<td>25.0</td>
<td>0.0</td>
<td>0.0</td>
<td>7.0</td>
<td>6.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>10.0</td>
<td>11.0</td>
<td>5.0</td>
<td>25.0</td>
<td>0.0</td>
<td>0.0</td>
<td>8.0</td>
<td>6.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.0</td>
<td>3.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.0</td>
<td>6.0</td>
<td>10.0</td>
<td>1.0</td>
<td>5.0</td>
<td>0.0</td>
<td>0.0</td>
<td>11.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>10.0</td>
<td>7.0</td>
<td>12.0</td>
<td>0.0</td>
<td>2.0</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>15.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>8.0</td>
<td>9.0</td>
<td>11.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>8.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>6.0</td>
<td>8.0</td>
<td>10.0</td>
<td>0.0</td>
<td>8.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>17.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The DataFrame <code>counts</code> contains now the pitch-class counts for all pieces. We can see if the dimensions of <code>counts</code> and <code>data</code> fit.</p>
<<<<<<< HEAD
<div id="21457ee2" class="cell" data-execution_count="29">
=======
<div id="53910b2e" class="cell" data-execution_count="29">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>counts.shape, data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>((9372, 12), (9372, 5))</code></pre>
</div>
</div>
<p>But now, longer pieces weight more just because they contain more notes. To avoid that we have to normalize the DataFrame to get relative frequencies.</p>
<<<<<<< HEAD
<div id="2022eeb8" class="cell" data-execution_count="30">
=======
<div id="b94eb766" class="cell" data-execution_count="30">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>normalized <span class="op">=</span> counts.div(counts.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>normalized.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.125926</td>
<td>0.237037</td>
<td>0.214815</td>
<td>0.170370</td>
<td>0.081481</td>
<td>0.088889</td>
<td>0.059259</td>
<td>0.014815</td>
<td>0.007407</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.250000</td>
<td>0.187500</td>
<td>0.062500</td>
<td>0.000000</td>
<td>0.250000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.187500</td>
<td>0.062500</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.000000</td>
<td>0.181818</td>
<td>0.303030</td>
<td>0.030303</td>
<td>0.151515</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0.208333</td>
<td>0.145833</td>
<td>0.250000</td>
<td>0.000000</td>
<td>0.041667</td>
<td>0.041667</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.312500</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.181818</td>
<td>0.204545</td>
<td>0.250000</td>
<td>0.000000</td>
<td>0.090909</td>
<td>0.045455</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.045455</td>
<td>0.181818</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>0.117647</td>
<td>0.156863</td>
<td>0.196078</td>
<td>0.000000</td>
<td>0.156863</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.039216</td>
<td>0.333333</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Now we are almoste done with transforming the data in order to answer our question. We still need to transpose all songs into the same key so that we can compare their pitch-class distributions. Let’s think a moment about how this can be done. We have the pitch-class distribution of each song in <code>counts</code>, and we have <code>key</code>, <code>root</code>, and <code>mode</code> in <code>data</code>.</p>
<p>Let’s say that we want to transpose all songs to the root C. C major and C minor pieces do not have to change. A piece in G major, for instance, has the root <code>7</code> and needs to be transposed to the root <code>0</code>. A piece in Bb minor has the root <code>10</code> and needs do be transposed to the root <code>0</code>. The easiest way to do this is to ‘rotate’ the pitch-class distributions by the negative amount of the root. Luckily, numpy provides the <code>roll</code> function to do exactly that. It takes an array (a vector) and rolls it by the specified amount. We do this for all songs in data and save the result in a new DataFrame <code>transposed</code>.</p>
<<<<<<< HEAD
<div id="99ab3809" class="cell" data-execution_count="31">
=======
<div id="f82bfda9" class="cell" data-execution_count="31">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>transposed <span class="op">=</span> pd.DataFrame(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    [ np.roll( normalized.iloc[i,:], <span class="op">-</span>data[<span class="st">'root'</span>][i] ) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data)) ]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>transposed.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.014815</td>
<td>0.007407</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.125926</td>
<td>0.237037</td>
<td>0.214815</td>
<td>0.170370</td>
<td>0.081481</td>
<td>0.088889</td>
<td>0.059259</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.187500</td>
<td>0.062500</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.250000</td>
<td>0.187500</td>
<td>0.062500</td>
<td>0.000000</td>
<td>0.250000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.181818</td>
<td>0.303030</td>
<td>0.030303</td>
<td>0.151515</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.312500</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.208333</td>
<td>0.145833</td>
<td>0.250000</td>
<td>0.000000</td>
<td>0.041667</td>
<td>0.041667</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.000000</td>
<td>0.045455</td>
<td>0.181818</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.181818</td>
<td>0.204545</td>
<td>0.250000</td>
<td>0.000000</td>
<td>0.090909</td>
<td>0.045455</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>0.000000</td>
<td>0.039216</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.117647</td>
<td>0.156863</td>
<td>0.196078</td>
<td>0.000000</td>
<td>0.156863</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>We can already observe that none of the first 10 songs in the dataset has the tritone (pitch class 6), and only one has a minor third (pitch class 3) or a minor seventh (pitch class 10).</p>
<p>It would be nice not having to work with to DataFrames, <code>data</code> and <code>transposed</code>, so we combine (concatenate) them in a new one, just called <code>df</code>.</p>
<<<<<<< HEAD
<div id="3e5fba7c" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([data, transposed], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bd56bae6" class="cell" data-execution_count="33">
=======
<div id="633415f1" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([data, transposed], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="071d4ddb" class="cell" data-execution_count="33">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>(9372, 17)</code></pre>
</div>
</div>
<<<<<<< HEAD
<div id="2a854ea4" class="cell" data-execution_count="34">
=======
<div id="427f082f" class="cell" data-execution_count="34">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">spelled_pitches</th>
<th data-quarto-table-cell-role="th">root</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Muwaschah Lamma Bada</td>
<td>g minor</td>
<td>[D5, G5, A5, B-5, C6, B-5, B-5, A5, A5, G5, G5...</td>
<td>7</td>
<td>minor</td>
<td>0.014815</td>
<td>0.007407</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.125926</td>
<td>0.237037</td>
<td>0.214815</td>
<td>0.170370</td>
<td>0.081481</td>
<td>0.088889</td>
<td>0.059259</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUCA 1</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUCA 2</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUCA 1</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.107692</td>
<td>0.092308</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.076923</td>
<td>0.123077</td>
<td>0.138462</td>
<td>0.076923</td>
<td>0.384615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUCA 2</td>
<td>F major</td>
<td>[C4, C4, C4, F4, A4, C4, C4, C4, F4, A4, F4, F...</td>
<td>5</td>
<td>major</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.114286</td>
<td>0.085714</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.071429</td>
<td>0.142857</td>
<td>0.157143</td>
<td>0.071429</td>
<td>0.357143</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="step-4-plot-your-first-pitch-class-histogram-and-pitch-class-distribution" class="level2">
<h2 class="anchored" data-anchor-id="step-4-plot-your-first-pitch-class-histogram-and-pitch-class-distribution">Step 4: Plot your first pitch class histogram and pitch class distribution</h2>
<ol type="1">
<li>Choose an example piece.</li>
<li>What do you expect to see?</li>
<li>Plot a pitch class histogram in chromatic order.</li>
</ol>
<<<<<<< HEAD
<div id="2ae6e90d" class="cell" data-execution_count="35">
=======
<div id="6c5199d0" class="cell" data-execution_count="35">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>piece <span class="op">=</span> df.iloc[<span class="dv">0</span>,<span class="op">-</span><span class="dv">11</span>:]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>piece.plot.bar(rot<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="03_melody_I_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-plot-the-averaged-pitch-class-distribution-for-the-major-and-the-minor-mode" class="level2">
<h2 class="anchored" data-anchor-id="step-5-plot-the-averaged-pitch-class-distribution-for-the-major-and-the-minor-mode">Step 5: Plot the averaged pitch class distribution for the major and the minor mode</h2>
<ol start="2" type="1">
<li>Plot the averaged distributions.</li>
<li>Can you show everything in one figure?</li>
<li>Would it also make sense to plot averaged pitch class histograms?</li>
</ol>
<<<<<<< HEAD
<div id="e6fd8898" class="cell" data-execution_count="36">
=======
<div id="178534dd" class="cell" data-execution_count="36">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>melted <span class="op">=</span> df.melt(id_vars<span class="op">=</span><span class="st">'mode'</span>,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                 value_vars<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>],</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                 var_name<span class="op">=</span><span class="st">'pitch_classes'</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                 value_name<span class="op">=</span><span class="st">'relative_frequencies'</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<<<<<<< HEAD
<div id="22859564" class="cell" data-execution_count="37">
=======
<div id="66aaa7a0" class="cell" data-execution_count="37">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>melted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">pitch_classes</th>
<th data-quarto-table-cell-role="th">relative_frequencies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>minor</td>
<td>0</td>
<td>0.014815</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>major</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>major</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>major</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>major</td>
<td>0</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<<<<<<< HEAD
<div id="a98a02c8" class="cell" data-execution_count="38">
=======
</div>
<div id="5f20f6b8" class="cell" data-execution_count="38">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>melted.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(112464, 3)</code></pre>
</div>
</div>
<<<<<<< HEAD
<div id="134f8438" class="cell" data-execution_count="39">
=======
<div id="e039cb07" class="cell" data-execution_count="39">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>melted, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>               x<span class="op">=</span><span class="st">'pitch_classes'</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>               y<span class="op">=</span><span class="st">'relative_frequencies'</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>               hue<span class="op">=</span><span class="st">'mode'</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>               kind<span class="op">=</span><span class="st">'bar'</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>               aspect<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>              )<span class="op">;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="03_melody_I_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-6-plot-the-averaged-distributions-in-fifths-ordering" class="level2">
<h2 class="anchored" data-anchor-id="step-6-plot-the-averaged-distributions-in-fifths-ordering">Step 6: Plot the averaged distributions in fifths ordering</h2>
<ol type="1">
<li>Create the plot.</li>
<li>What do you see?</li>
</ol>
<<<<<<< HEAD
<div id="c150ddd3" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>melted[<span class="st">'fifths'</span>] <span class="op">=</span> melted[<span class="st">'pitch_classes'</span>] <span class="op">*</span> <span class="dv">7</span> <span class="op">%</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f3c4ae27" class="cell" data-execution_count="41">
=======
<div id="21df0bdc" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>melted[<span class="st">'fifths'</span>] <span class="op">=</span> melted[<span class="st">'pitch_classes'</span>] <span class="op">*</span> <span class="dv">7</span> <span class="op">%</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="72e79946" class="cell" data-execution_count="41">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>melted, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>               x<span class="op">=</span><span class="st">'fifths'</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>               y<span class="op">=</span><span class="st">'relative_frequencies'</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>               hue<span class="op">=</span><span class="st">'mode'</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>               kind<span class="op">=</span><span class="st">'bar'</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>               aspect<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>              )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="03_melody_I_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-7-extend-the-plot-above-to-show-the-diffusion-of-each-pitch-class" class="level2">
<h2 class="anchored" data-anchor-id="step-7-extend-the-plot-above-to-show-the-diffusion-of-each-pitch-class">Step 7: Extend the plot above to show the diffusion of each pitch class</h2>
<ol type="1">
<li>Decide to either use error bars, boxplots, or violin plots. What is the difference between them? Violin plots are of cause the most fancy figures…</li>
<li>Describe what you see.</li>
</ol>
<<<<<<< HEAD
<div id="3f6cee45" class="cell" data-execution_count="42">
=======
<div id="22e41d57" class="cell" data-execution_count="42">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">10</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>melted,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'pitch_classes'</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'relative_frequencies'</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'mode'</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    fliersize<span class="op">=</span><span class="fl">2.5</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="03_melody_I_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These boxplots show already much more! For example, they reveal that there are many outliers which we can’t see in the bar plot. https://www.autodeskresearch.com/publications/samestats</p>
<<<<<<< HEAD
<div id="ac0b38df" class="cell" data-execution_count="43">
=======
<div id="e7c8224e" class="cell" data-execution_count="43">
>>>>>>> refs/remotes/origin/main
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">10</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sns.violinplot(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>melted,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'pitch_classes'</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'relative_frequencies'</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'mode'</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    inner<span class="op">=</span><span class="st">'quart'</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    split<span class="op">=</span><span class="va">True</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="03_melody_I_files/figure-html/cell-44-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../ex/02_python_primer.html" class="pagination-link" aria-label="Exercise for Week 2">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exercise for Week 2</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../references.html" class="pagination-link" aria-label="REFERENCES">
        <span class="nav-page-text">REFERENCES</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>